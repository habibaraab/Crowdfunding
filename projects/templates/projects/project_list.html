{% extends "projects/base.html" %}

{% block title %}Browse Projects{% endblock %}

{% block content %}
<div class="project-list-container">
    <h2>Available Projects</h2>

    <div class="search-container">
        <form method="GET" action="{% url 'project_list' %}">
            <label for="search_date">Search for active projects on date:</label>
            <input type="date" id="search_date" name="search_date" value="{{ search_date|default:'' }}" class="search-date-input">
            
            <button type="submit" class="nav-btn">Search</button>
            
            {% if search_date %}
                <a href="{% url 'project_list' %}" class="clear-search-link">Clear Search</a>
            {% endif %}
        </form>
    </div>
    {% if user.is_authenticated %}
        <a href="{% url 'create_project' %}" class="nav-btn" style="margin-bottom: 20px; display: inline-block;">+ Add New Project</a>
    {% endif %}

    <div class="project-grid">
        {% for project in projects %}
            <a href="{% url 'project_detail' project.id %}" class="project-card-link">
                <div class="project-card">
                    {% if project.main_picture %}
                        <img src="{{ project.main_picture.url }}" alt="{{ project.title }}" class="project-image">
                    {% endif %}
                    <div class="card-content">
                        <h3>{{ project.title }}</h3>
                        <p class="project-creator">By: {{ project.creator.username }}</p>
                        <p class="project-details">{{ project.details|truncatewords:20 }}</p>
                        <div class="funding-info">
                            <p><strong>Target:</strong> {{ project.total_target }} EGP</p>
                        </div>
                    </div>
                </div>
            </a>
        {% empty %}
            {% if search_date %}
                <p>No active projects on this date.</p>
            {% else %}
                <p>No projects available at the moment.</p>
            {% endif %}
        {% endfor %}
    </div>
</div>
{% endblock %}